<?xml version="1.0"?>

<project name="Get SWT" default="get-swt" basedir=".">
<!-- ================================================================================== -->
<!-- The swt qt code uses linked resources to point to the base SWT code.  This script  -->
<!-- will get a particular version of SWT and put it in the linked resource directory.  -->
<!-- ================================================================================== -->

<property name="swt.version" value="v3124"/>
<property name="swtDir" value="org.eclipse.swt"/>
<property name="tmpDir" value="tmp"/>
<property name="commonSwtDir" value="SWT-common"/>
<property name="swtBaseDir" value="${swtDir}/Eclipse SWT/common/org/eclipse/swt"/>
<property name="swtEventsDir" value="${swtDir}/Eclipse SWT/common/org/eclipse/swt/events"/>
<property name="swtLayoutDir" value="${swtDir}/Eclipse SWT/common/org/eclipse/swt/layout"/>
<property name="swtInternalDir" value="${swtDir}/Eclipse SWT/common/org/eclipse/swt/internal"/>
<property name="swtGraphicsDir" value="${swtDir}/Eclipse SWT/common/org/eclipse/swt/graphics"/>
<property name="swtWidgetsDir" value="${swtDir}/Eclipse SWT/common/org/eclipse/swt/widgets"/>
<property name="swtBrowserDir" value="${swtDir}/Eclipse SWT Browser/common/org/eclipse/swt/browser"/>
<property name="swtLibraryDir" value="${swtDir}/Eclipse SWT/common/library"/>
<property name="swtCommonDir" value="Eclipse SWT/common"/>
<property name="swtCommonBrowserDir" value="Eclipse SWT Browser/common"/>

<target name="get-swt">
	<antcall target="get"/> 
	<antcall target="delete-folders"/> 
	<antcall target="delete-files"/> 
	<antcall target="delete-cvs"/> 
	<antcall target="move-cvs"/> 
</target>

<!-- Get the SWT Projects from CVS -->
<target name="get">	
	<delete dir="${tmpDir}"/>
	<delete dir="${commonSwtDir}"/>
	<mkdir dir="${tmpDir}"/>
	<exec executable="cvs" dir="${tmpDir}" > <arg line="-q -d :pserver:anonymous@dev.eclipse.org:/home/eclipse checkout -r ${swt.version} ${swtDir}"/> </exec>
</target>

<target name="delete-folders">	
	<delete dir="${tmpDir}/${swtEventsDir}"/>
	<delete dir="${tmpDir}/${swtGraphicsDir}"/>
	<delete dir="${tmpDir}/${swtInternalDir}"/>
	<delete dir="${tmpDir}/${swtWidgetsDir}"/>
	<delete includeEmptyDirs="true">
		<fileset dir="${tmpDir}" defaultexcludes="no">
			<include name ="${swtImageDir}/**"/>
    	</fileset> 
	</delete>

	<delete includeEmptyDirs="true">
		<fileset dir="${tmpDir}/${swtDir}" defaultexcludes="no">
			<exclude name ="${swtCommonDir}/**"/>
			<exclude name ="${swtCommonBrowserDir}/**"/>
    	</fileset> 
	</delete>
	<delete> 
		<fileset dir="${tmpDir}/${swtBaseDir}" includes="*.*"/>
	</delete>
	<delete dir="${tmpDir}/${swtLibraryDir}"/>
</target>

<target name="delete-files">
	<!-- Remove Layout classes except for FormLayout -->
	<delete file="${tmpDir}/${swtLayoutDir}/FormLayout.java"/>	 
	<delete file="${tmpDir}/${swtLayoutDir}/FormData.java"/>
	<delete file="${tmpDir}/${swtLayoutDir}/FormAttachment.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/LocationAdapter.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/ProgressAdapter.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/VisibilityWindowAdapter.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/VisibilityWindowAdapter.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/VisibilityWindowAdapter.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/CloseWindowListener.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/OpenWindowListener.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/VisibilityWindowListener.java"/>
	<delete file="${tmpDir}/${swtBrowserDir}/WindowEvent.java"/>
</target>

<target name="delete-cvs">	
	<delete includeEmptyDirs="true">
		<fileset dir="${tmpDir}" defaultexcludes="no">
			<include name="**/CVS/**"/>
    	</fileset> 
	</delete>
</target>

<target name="move-cvs">	
  	<move todir="${basedir}/${commonSwtDir}">
    	<fileset dir="${tmpDir}/${swtDir}/${swtCommonDir}"/>
  	</move>
  	<move todir="${basedir}/${commonSwtDir}">
    	<fileset dir="${tmpDir}/${swtDir}/${swtCommonBrowserDir}"/>
  	</move>
	<delete dir="${tmpDir}"/>
</target>

</project>